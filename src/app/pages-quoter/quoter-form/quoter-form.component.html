
<div class="grid grid-cols-1 gap-2 mb-2  ">
    <!-- card  1 -->
     <div class="grid grid-cols-2 gap-4">
        <div class=" bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
            <div class=" p-6 flex justify-between gap-4">
                <!-- Columna Izquierda -->
                <div class="w-full space-y-4">
                    <div class=" grid grid-cols-2 gap-4">
                        <div>
                           <label for="travel_agent" class="block text-sm font-medium text-gray-700">Travel Designer</label>
                           <select name="travel_agent" id="travel_agent" [(ngModel)]="newQuoter.travel_agent" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                            <option value="NV">NV</option>
                            <option value="IVL">IVL</option>
                            <option value="TG">TG</option>
                            <option value="TA">TA</option>
                            <option value="MK">MK</option>
                            <option value="ME">ME</option>

                           </select>
                        </div>
                        <div class="relative">
                     
                          
                            <label for="guest"  class="block text-sm font-medium text-gray-700">Guest</label>
                            <input
                                id="searchInput"
                                type="text"
                                [(ngModel)]="newQuoter.guest"
                                (input)="filterOptions()"  
                                (focus)="showOptions = true"
                                name="search"
                                placeholder="Search Guest..."
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                            />
                            <!-- Opciones filtradas -->
                            <ul id="optionsDropdown" *ngIf="showOptions && filteredOptions.length" class="absolute left-0 right-0 bg-white border border-gray-300 mt-1 rounded-md max-h-40 overflow-auto z-10">
                                <li
                                *ngFor="let option of filteredOptions"
                                (click)="selectOption(option)"
                                class="p-2 hover:bg-gray-200 cursor-pointer"
                                >
                                {{ option.name }}
                                </li>
                            </ul>
                        </div>
                  
                        <div>
                            <label for="travel-start-date" class="block text-sm font-medium text-gray-700">Travel Dates</label>
                            <input type="date" [(ngModel)]="newQuoter.travelDate.start" name="newQuoter.travelDate.start" id="travel-start-date" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="travel-end-date" class="block text-sm font-medium text-gray-700">&nbsp;</label> <!-- Etiqueta vacÃ­a para alinear -->
                            <input type="date" [(ngModel)]="newQuoter.travelDate.end" name="newQuoter.travelDate.end" id="travel-end-date" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        </div>
                    
                        <div>
                            <label for="accommodations" class="block text-sm font-medium text-gray-700">Type of Accommodations</label>
                            <input type="text" [(ngModel)]="newQuoter.accomodations" name="newQuoter.acomodations" id="accommodations" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Accommodations">
                        </div>
                        <div>
                            <label for="number_paxs" class="block text-sm font-medium text-gray-700">Number of Guest</label>
                            <div class="flex flex-initial items-center space-x-4">
                                @for (item of newQuoter.number_paxs; track $index) {
                                    <!-- <input type="number" [(ngModel)]="newQuoter.number_paxs[$index]"   name="newQuoter.number_paxs_{{$index}}" id="number_paxs_{{$index}}" class="mt-1 block w-16 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Value" required>
                                    <i class="bx bx-minus-circle text-2xl text-red-500 dark:text-red-700 " (click)="removeNumberPaxs($index)"></i> -->
                                    <div class="flex items-center space-x-2">
                                        <!-- Input -->
                                        <input type="number" [(ngModel)]="newQuoter.number_paxs[$index]" 
                                               name="newQuoter.number_paxs_{{$index}}" 
                                               id="number_paxs_{{$index}}" 
                                               class="mt-1 block w-16 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" 
                                               placeholder="Value" required>
                                      
                                        <!-- Icono de eliminar -->
                                        <i class="bx bx-minus-circle text-2xl text-red-500 dark:text-red-700 cursor-pointer" (click)="removeNumberPaxs($index)"></i>
                                      </div>
                                }
                                <i class="bx bxs-plus-circle text-2xl text-green-500 dark:text-green-700 " (click)="addNumberPaxs()"></i>
                                
                              
                            </div>

                            @if (!newQuoter.number_paxs) {
                                <span class="flex items-center font-medium tracking-wide text-red-500 text-xs mt-1 ml-1">
                                    Invalid username field !
                                </span>
                            }

                        </div>
                        <div class="col-span-2">
                            <div>
                                <label for="destinations" class="block text-sm font-medium text-gray-700">Destinations</label>
                               <div class="mt-1 py-2 p-3">
                                @for (item of destinations; track $index) {
                                <label class=" mt-1 py-2 p-3">
                                    <input
                                      type="checkbox"
                                      name="Destinations"
                                    />
                                    {{item}}
                                 </label>
                                }
                            </div>
                                <!-- <input type="date" id="issue-date" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Value"> -->
                            </div>
                            <div class="pt-6">
                                @if (showUpdate== false) {
                                    <!-- <button (click)="onSubmit()" class="px-4 bg-green-500 dark:bg-green-700 p-3  rounded-lg text-white hover:bg-green-600 dark:hover:bg-green-800" >Submit</button> -->
                                    <button (click)="onSubmit()" type="button" class="inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-400 shadow-sm hover:bg-green-300 hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600">
                                        <span class="">
                                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z" />
                                      </svg>
                                      
                                        </span>
                                        <span class="">Save</span></button>
                                }@else {
                                    <button type="button" (click)="onUpdate()" class="inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-black-400 shadow-sm hover:bg-green-400 hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600" >
                                        <span class="">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                                              </svg>
                                              
                                          </span>
                                          <span class="">Update</span></button>
                                          <button type="button" (click)="onSubmit()" class="inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-black-400 shadow-sm hover:bg-green-400 hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600" >
                                            <span class="">
                                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                                                  </svg>
                                                  
                                              </span>
                                              <span class="">Create new version</span></button>
                                }
        
                                <button type="button" class="inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-400 shadow-sm hover:bg-red-400 hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600" (click)="generatePDF()">
                                    <span class="">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15" />
                                          </svg>
                                      </span>
                                      <span class="">Cancel</span></button>
                                <!-- <button class="px-4 bg-blue-500 dark:bg-blue-700 p-3 ml-3 rounded-lg text-white hover:bg-blue-600 dark:hover:bg-blue-800" (click)="generatePDF()">Download PDF</button> -->
                                <button type="button" class="inline-flex items-center gap-x-2 rounded-md bg-transparent px-3.5 py-2.5 text-sm font-semibold text-gray-400 shadow-sm hover:bg-gray-400 hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600" (click)="generatePDF()">
                                <span class="">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15M9 12l3 3m0 0 3-3m-3 3V2.25" />
                                </svg>
                                
                                  </span>
                                  <span class="">Download</span></button>
                            </div>
                        </div>
                    </div>
                </div>

             
            </div>

    </div>
    <div class="bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
        <div class="px-6 flex justify-between gap-4">
            <!-- Columna Izquierda -->
            <div class="w-full space-y-4">
                <div class="grid grid-cols-1 gap-4 justify-start px-6 w-full overflow-x-auto">
                  
                
                <div>
                    <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                    <tbody class="">
                        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                            <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">Total Cost
                            </td>
                              @for (price of getTotalCosts(); track $index) {
                              <td class="px-6 py-4">{{price | currency}}</td>
                            }@empty {
                              <td class="px-6 py-4">$0.00</td>
                            }
            
                        </tr>
                        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                            <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-whit">EXTERNAL UTILITY
                            </td>
                            @for (price of [].constructor(newQuoter.number_paxs.length); track $index) {
                              <td class="px-6 py-4">
                                <!-- <input [value]="prueba6()[$index]" (input)="onInputChange($event, $index)"  type="number"> -->
                                
                                <div class="relative mt-2 rounded-md shadow-sm">
                                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                      <span class="text-gray-500 sm:text-sm">$</span>
                                    </div>
                                    <input  [value]="prueba6()[$index]" (input)="onInputChange($event, $index)"  type="number" name="price" id="price" class="block w-full rounded-md border-0 py-1.5 pl-7 pr-4 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm/6" placeholder="0.00">
                                  </div>

                              </td> 
                            }@empty {
                              <td class="px-6 py-4">$0.00</td>
                            }
                        </tr>
                        <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                          <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">EXTERNAL TAXES
                          </td>
                          @for (price of getExternalTaxes(); track $index) {
                            <td class="px-6 py-4">{{price | currency}}</td>
                          }@empty {
                            <td class="px-6 py-4">$0.00</td>
                          }
                      </tr>
                      <tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                        <td  class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white">TOTAL COST EXTERNAL</td>
                            @for (price of getTotalCostExternal() ;track $index) {
                                <td class="px-6 py-4">{{price | currency}}</td>
            
                            }@empty {
                                <td class="px-6 py-4">$0.00</td>
                              }
                      </tr>
                    </tbody>
                    </table>
                </div>
                <div>
                    <table class="items-center w-full bg-transparent border border-collapse ">
                    <tbody class="bg-stone-200">
                        <tr>
                            <td class="text-gray-600 text-sm font-medium ml-2 truncate text-right">Subtotal
                            </td>
                            @for (price of subTotal(); track $index) {
                              <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">{{price | currency}}</td>
                            }@empty {
                              <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">$0.00</td>
                            }
                        </tr>
                        <tr>
                          <td class="text-gray-600 text-sm font-medium ml-2 truncate text-right">Cost of Transfers
                          </td>
                          @for (price of costOfTransfers(); track $index) {
                            <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">{{price | currency}}</td>
                          }@empty {
                            <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">$0.00</td>
                          }
                      </tr>
                      <tr>
                        <td  class="border-t-2 border-gray-300 px-4 py-2 text-right">Final Cost</td>
                            @for (price of final_cost(); track $index) {
                                <td class="border-t-2 border-gray-300 px-4 py-2 text-emerald-500 text-left">{{price | currency}}</td>
            
                            }@empty {
                                <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">$0.00</td>
                              }
                      </tr>
                      <tr>
                        <td  class="border-t-2 border-gray-300 px-4 py-2 text-right">Cost Per Person</td>
                            @for (price of price_per_person(); track $index) {
                                <td class="border-t-2 border-gray-300 px-4 py-2 text-emerald-500 text-left"> {{ price | currency:'USD':'symbol':'1.2-2' }}</td>
            
                            }@empty {
                                <td class="py-2 px-4 border-b text-emerald-500 border-b-gray-50">$0.00</td>
                              }
                      </tr>
                    </tbody>
                    </table>
                </div>
                </div>
            </div>
            </div>
        </div>
     </div>
    
    <!-- end card  1 -->
    <!-- card  2 -->
    <div class="bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
            
            <app-services
            [number_paxs]="newQuoter.number_paxs"  
            [services]="newQuoter.services"      
            (servicesChange)="onServicesUpdate($event)"
            (openModalEvent)="openModal()"
            (totalPricesChange)="onTotalPricesServicesChange($event)">
            </app-services>
            <app-hotels
            [priceLength]="newQuoter.number_paxs.length"
            [hotels]="newQuoter.hotels"
            (hotelsChange)="onHotelsUpdate($event)"
            (totalPricesChange)="onTotalPricesHotelsChange($event)">
            </app-hotels>
           
    </div>
    <!-- end card  2 -->

     <!-- card 5 external operator -->
    <div class="bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
        <app-ext-operator 
        [priceLength]="newQuoter.number_paxs.length"
        [operators]="newQuoter.operators"
        [porcentajeTd]="newQuoter.total_prices.porcentajeTD"
        (porcentajeChange)="onPorcentajeTDUpdate($event)"
        (operatorsChange)="onOperatorsUpdate($event)"
        (totalPricesChange)="onTotalPricesOperatorsChange($event)">
        </app-ext-operator>
    </div>
    <!-- end card 5 -->
    <div class="bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
        <app-cruceros
        [paxs]="newQuoter.number_paxs"
        [cruises]="newQuoter.cruises"
        (cruisesChange)="onCruiseUpdate($event)"
        (totalPricesChange)="onTotalPricesCruiseChange($event)"
        ></app-cruceros>
    </div>
    <!-- card  6 -->
    <div class="bg-white rounded-md border border-gray-100 p-6 shadow-md shadow-black/5">
        <app-flights
        [paxs]="newQuoter.number_paxs"
        [flights]="newQuoter.flights"
        (flightsChange)="onFlightsUpdate($event)"
        (totalPricesChange)="onTotalPricesFligtsChange($event)"
        >
        </app-flights>
    </div>
    <!-- end card  6 -->
</div>

<!-- @if (modalOpen()) {
    <app-master-quoter (servicesChange)="onModalmqQuoterChange($event)" [numberpaxs]="newQuoter.number_paxs" (closeModalEvent)="closeModal()"></app-master-quoter>
} -->
